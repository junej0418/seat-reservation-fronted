<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>ëœì„ ì„ ì˜ˆì•½ ì‹œìŠ¤í…œ</title>
<style>
  /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
  body {
    font-family: 'Malgun Gothic', Arial, sans-serif;
    margin: 0; padding: 10px 0;
    background: #fafafc;
    color: #2c3e50;
  }
  h1, h2 {
    text-align: center;
    margin: 1em 0;
    color: #334155;
  }
  .container {
    max-width: 960px;
    margin: 10px auto;
    padding: 20px;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 14px rgba(0,0,0,0.08);
  }

  /* ì…ë ¥ í¼ */
  .input-group { margin-bottom: 1em; }
  .input-group label {
    display: block;
    margin-bottom: 0.4em;
    font-weight: 600;
    font-size: 0.9em;
    color: #334155;
  }
  .input-group input,
  .input-group select {
    width: 100%;
    padding: 12px;
    border: 1px solid #cbd5e1;
    border-radius: 6px;
    font-size: 1em;
    box-sizing: border-box;
  }
  .input-group input:focus,
  .input-group select:focus {
    outline: none;
    border-color: #6366f1;
  }

  /* ë²„íŠ¼ */
  .btn {
    width: 100%;
    padding: 14px;
    margin-top: 0.8em;
    border: none;
    border-radius: 8px;
    font-size: 1em;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
  }
  .btn-primary {
    background: #6366f1;
    color: white;
  }
  .btn-primary:hover:not(:disabled) {
    background: #4f46e5;
  }
  .btn-primary:disabled {
    background: #cbd5e1;
    cursor: not-allowed;
  }
  .btn-secondary {
    background: #64748b;
    color: white;
  }
  .btn-secondary:hover {
    background: #475569;
  }
  .btn-danger {
    background: #ef4444;
    color: white;
  }
  .btn-danger:hover {
    background: #dc2626;
  }
  .btn-success {
    background: #10b981;
    color: white;
  }
  .btn-success:hover {
    background: #059669;
  }

  /* ì„¹ì…˜ ì „í™˜ */
  .section {
    display: none;
  }
  .section.active {
    display: block;
  }

  /* ì¢Œì„ ì„ íƒ */
  .floor-container {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    margin-top: 1.2em;
  }
  .floor-btn {
    flex: 1 1 calc(50% - 6px);
    padding: 18px;
    background: #6366f1;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 1.1em;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
  }
  .floor-btn:hover {
    background: #4f46e5;
  }

  /* ì¢Œì„ ê·¸ë¦¬ë“œ */
  .seats {
    display: grid;
    grid-template-columns: repeat(10, 1fr);
    gap: 8px;
    margin-top: 1.5em;
  }
  .seat {
    aspect-ratio: 1;
    border: 2px solid #cbd5e1;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    background: white;
    font-size: 0.9em;
  }
  .seat.available {
    background: #d1fae5;
    border-color: #10b981;
    color: #065f46;
  }
  .seat.available:hover {
    background: #a7f3d0;
  }
  .seat.reserved {
    background: #fee2e2;
    border-color: #ef4444;
    color: #991b1b;
    cursor: not-allowed;
  }
  .seat.my-seat {
    background: #dbeafe;
    border-color: #3b82f6;
    color: #1e3a8a;
  }

  /* ë²”ë¡€ */
  .legend {
    display: flex;
    justify-content: center;
    gap: 16px;
    margin: 1em 0;
    flex-wrap: wrap;
  }
  .legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.85em;
  }
  .legend-box {
    width: 16px;
    height: 16px;
    border-radius: 3px;
    border: 2px solid;
  }
  .legend-box.available {
    background: #d1fae5;
    border-color: #10b981;
  }
  .legend-box.reserved {
    background: #fee2e2;
    border-color: #ef4444;
  }
  .legend-box.my-seat {
    background: #dbeafe;
    border-color: #3b82f6;
  }

  /* ê´€ë¦¬ì í…Œì´ë¸” */
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1em;
  }
  th, td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #e2e8f0;
  }
  th {
    background: #f1f5f9;
    font-weight: 600;
    color: #334155;
  }
  tbody tr:hover {
    background: #fafafa;
  }

  /* ëª¨ë‹¬ */
  .modal {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.6);
    align-items: center;
    justify-content: center;
    z-index: 9999;
  }
  .modal.active {
    display: flex;
  }
  .modal-content {
    background: white;
    padding: 30px;
    border-radius: 12px;
    max-width: 500px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
  }
  .modal-content h2 {
    margin-top: 0;
  }
  .modal-content .btn {
    margin-top: 1em;
  }

  /* ê°œì¸ì •ë³´ ë™ì˜ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
  #privacyConsentModal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.7);
    align-items: center;
    justify-content: center;
    z-index: 10000;
  }
  #privacyConsentModal.active {
    display: flex;
  }
  #privacyConsentModal .modal-content {
    background: white;
    padding: 30px;
    border-radius: 12px;
    max-width: 650px;
    width: 90%;
    max-height: 85vh;
    overflow-y: auto;
  }
  #privacyConsentModal h2 {
    color: #334155;
    border-bottom: 2px solid #6366f1;
    padding-bottom: 10px;
    text-align: center;
    margin-bottom: 20px;
  }
  #privacyConsentModal h3 {
    color: #6366f1;
    margin-top: 18px;
    margin-bottom: 10px;
    font-size: 1em;
  }
  #privacyConsentModal p, #privacyConsentModal li {
    color: #475569;
    font-size: 0.9em;
    line-height: 1.7;
  }
  #privacyConsentModal ul {
    margin-left: 20px;
    margin-bottom: 12px;
  }
  .privacy-content {
    background: #f8fafc;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 20px;
  }
  .consent-checkbox-wrapper {
    text-align: center;
    margin: 25px 0;
  }
  .consent-checkbox-wrapper label {
    font-size: 1em;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    cursor: pointer;
    color: #334155;
  }
  .consent-checkbox-wrapper input[type="checkbox"] {
    width: 20px;
    height: 20px;
    margin-right: 10px;
    cursor: pointer;
  }
  .privacy-buttons {
    display: flex;
    gap: 12px;
    justify-content: center;
  }
  .privacy-buttons button {
    padding: 12px 40px;
    font-size: 1em;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s;
  }
  #privacyConsentAgreeBtn {
    background: #10b981;
    color: white;
  }
  #privacyConsentAgreeBtn:hover {
    background: #059669;
  }
  #privacyConsentCancelBtn {
    background: #ef4444;
    color: white;
  }
  #privacyConsentCancelBtn:hover {
    background: #dc2626;
  }

  /* ë°˜ì‘í˜• */
  @media (max-width: 600px) {
    .seats {
      grid-template-columns: repeat(5, 1fr);
      gap: 6px;
    }
    .seat {
      font-size: 0.75em;
    }
    .floor-btn {
      flex: 1 1 100%;
    }
  }

  /* ë¹„ë°€ë²ˆí˜¸ ê°•ë„ í‘œì‹œ */
  .password-strength {
    margin-top: 0.5em;
    font-size: 0.85em;
    font-weight: 600;
  }
  .strength-weak { color: #ef4444; }
  .strength-medium { color: #f59e0b; }
  .strength-strong { color: #10b981; }

  /* ê³µì§€ì‚¬í•­ ìŠ¤íƒ€ì¼ */
  .notice {
    background: #fef3c7;
    border-left: 4px solid #f59e0b;
    padding: 12px;
    margin: 1em 0;
    border-radius: 6px;
    font-size: 0.9em;
  }

  /* ê´€ë¦¬ì ì„¹ì…˜ */
  .admin-section {
    margin-bottom: 2em;
    padding: 20px;
    background: #f8fafc;
    border-radius: 10px;
  }
  .admin-section h3 {
    color: #6366f1;
    margin-top: 0;
    margin-bottom: 1em;
  }
  textarea {
    width: 100%;
    padding: 12px;
    border: 1px solid #cbd5e1;
    border-radius: 6px;
    font-size: 1em;
    box-sizing: border-box;
    resize: vertical;
    min-height: 100px;
    font-family: inherit;
  }
  textarea:focus {
    outline: none;
    border-color: #6366f1;
  }
  .checkbox-label {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 0.8em;
    cursor: pointer;
  }
  .checkbox-label input[type="checkbox"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
  }

  /* ì‘ì€ ë²„íŠ¼ */
  .btn-small {
    padding: 6px 12px;
    font-size: 0.85em;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 600;
    margin-right: 4px;
  }
  .btn-small.btn-info {
    background: #3b82f6;
    color: white;
  }
  .btn-small.btn-info:hover {
    background: #2563eb;
  }
  .btn-small.btn-danger {
    background: #ef4444;
    color: white;
  }
  .btn-small.btn-danger:hover {
    background: #dc2626;
  }
</style>
</head>
<body>

<!-- ë¡œê·¸ì¸ í˜ì´ì§€ -->
<div id="loginPage" class="section">
  <div class="container">
    <h1>ğŸ–¥ï¸ ëœì„ ì„ ì˜ˆì•½ ë¡œê·¸ì¸</h1>
    <div class="input-group">
      <label for="roomNoInput">ë£¸ ë²ˆí˜¸ (000í˜¸ í˜•ì‹):</label>
      <input type="text" id="roomNoInput" placeholder="ì˜ˆ: 123" maxlength="3" />
    </div>
    <div class="input-group">
      <label for="nameInput">ì´ë¦„ (í•œê¸€ 2~4ì):</label>
      <input type="text" id="nameInput" placeholder="í™ê¸¸ë™" />
    </div>
    <div class="input-group">
      <label for="dormitorySelect">ê¸°ìˆ™ì‚¬ ì„ íƒ:</label>
      <select id="dormitorySelect">
        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
        <option value="ê¿ˆë™">ê¿ˆë™</option>
        <option value="ë¯¸ë˜ë™">ë¯¸ë˜ë™</option>
      </select>
    </div>
    <div class="input-group">
      <label for="passwordInput">ì˜ˆì•½ ë¹„ë°€ë²ˆí˜¸ (4ì ì´ìƒ):</label>
      <input type="password" id="passwordInput" placeholder="ë¹„ë°€ë²ˆí˜¸" />
      <div id="passwordStrength" class="password-strength"></div>
    </div>
    <button class="btn btn-primary" id="loginSubmitBtn">ë‹¤ìŒ</button>
    <button class="btn btn-secondary" id="goToAdminLoginBtn">ê´€ë¦¬ì ë¡œê·¸ì¸</button>
  </div>
</div>

<!-- ì¸µ ì„ íƒ í˜ì´ì§€ -->
<div id="floorSelectPage" class="section">
  <div class="container">
    <h1><span id="userNameDisplay"></span>ë‹˜, ì¸µì„ ì„ íƒí•´ì£¼ì„¸ìš”</h1>
    <div class="floor-container">
      <button class="floor-btn" data-floor="2ì¸µ">2ì¸µ</button>
      <button class="floor-btn" data-floor="3ì¸µ">3ì¸µ</button>
      <button class="floor-btn" data-floor="4ì¸µ">4ì¸µ</button>
      <button class="floor-btn" data-floor="5ì¸µ">5ì¸µ</button>
    </div>
    <button class="btn btn-secondary" id="backToLoginFromFloorBtn">ë’¤ë¡œê°€ê¸°</button>
    <button class="btn btn-success" id="goToSeatSelectionBtn">ì¢Œì„ ì„ íƒìœ¼ë¡œ</button>
  </div>
</div>

<!-- ì¢Œì„ ì„ íƒ í˜ì´ì§€ -->
<div id="seatSelectPage" class="section">
  <div class="container">
    <h2>ì¢Œì„ ë°°ì¹˜ë„ - <span id="currentFloorDisplay"></span></h2>
    <div class="legend">
      <div class="legend-item">
        <div class="legend-box available"></div>
        <span>ë¹ˆìë¦¬</span>
      </div>
      <div class="legend-item">
        <div class="legend-box reserved"></div>
        <span>ì˜ˆì•½ë¨</span>
      </div>
      <div class="legend-item">
        <div class="legend-box my-seat"></div>
        <span>ë‚´ ìë¦¬</span>
      </div>
    </div>
    <div class="seats" id="seatGrid"></div>
    <button class="btn btn-secondary" id="backToFloorFromSeatBtn">ë’¤ë¡œê°€ê¸°</button>
    <button class="btn btn-danger" id="cancelReservationBtn">ë‚´ ì˜ˆì•½ ì·¨ì†Œ</button>
    <button class="btn btn-success" id="confirmReservationBtn">ì˜ˆì•½ í™•ì •</button>
  </div>
</div>

<!-- ê´€ë¦¬ì ë¡œê·¸ì¸ í˜ì´ì§€ -->
<div id="adminLoginPage" class="section">
  <div class="container">
    <h1>ğŸ” ê´€ë¦¬ì ë¡œê·¸ì¸</h1>
    <div class="input-group">
      <label for="adminUsernameInput">ê´€ë¦¬ì ì´ë¦„:</label>
      <input type="text" id="adminUsernameInput" placeholder="ê´€ë¦¬ì ì´ë¦„" />
    </div>
    <div class="input-group">
      <label for="adminPasswordInput">ë¹„ë°€ë²ˆí˜¸:</label>
      <input type="password" id="adminPasswordInput" placeholder="ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸" />
    </div>
    <button class="btn btn-primary" id="adminLoginSubmitBtn">ë¡œê·¸ì¸</button>
    <button class="btn btn-secondary" id="backToLoginFromAdminBtn">ë¡œê·¸ì¸í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°</button>
  </div>
</div>

<!-- ê´€ë¦¬ì í˜ì´ì§€ -->
<div id="adminPage" class="section">
  <div class="container">
    <h1>âš™ï¸ ê´€ë¦¬ì í˜ì´ì§€</h1>
    <button class="btn btn-danger" id="adminLogoutBtn">ë¡œê·¸ì•„ì›ƒ</button>

    <!-- ì˜ˆì•½ ê°€ëŠ¥ ì‹œê°„ ì„¤ì • -->
    <div class="admin-section">
      <h3>ğŸ“… ì˜ˆì•½ ê°€ëŠ¥ ì‹œê°„ ì„¤ì •</h3>
      <div class="input-group">
        <label for="reservationStartTime">ì˜ˆì•½ ì‹œì‘ ì‹œê°„:</label>
        <input type="datetime-local" id="reservationStartTime" />
      </div>
      <div class="input-group">
        <label for="reservationEndTime">ì˜ˆì•½ ì¢…ë£Œ ì‹œê°„:</label>
        <input type="datetime-local" id="reservationEndTime" />
      </div>
      <button class="btn btn-success" id="saveTimesBtn">ì‹œê°„ ì„¤ì • ì €ì¥</button>
    </div>

    <!-- ì „ì²´ ê³µì§€ì‚¬í•­ -->
    <div class="admin-section">
      <h3>ğŸ“¢ ì „ì²´ ê³µì§€ì‚¬í•­ ì„¤ì • (ì‚¬ìš©ìì—ê²Œë„ í‘œì‹œ)</h3>
      <div class="input-group">
        <label for="announcementText">ê³µì§€ ë‚´ìš©:</label>
        <textarea id="announcementText" placeholder="ê³µì§€ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
      </div>
      <label class="checkbox-label">
        <input type="checkbox" id="announcementActive" />
        <span>ê³µì§€ í™œì„±í™”</span>
      </label>
      <button class="btn btn-success" id="saveAnnouncementBtn">ê³µì§€ ì €ì¥</button>
    </div>

    <!-- ê´€ë¦¬ì ì „ìš© ê³µì§€ì‚¬í•­ -->
    <div class="admin-section">
      <h3>ğŸ”’ ê´€ë¦¬ì ì „ìš© ê³µì§€ì‚¬í•­ ì„¤ì • (ê´€ë¦¬ìì—ê²Œë§Œ í‘œì‹œ)</h3>
      <div class="input-group">
        <label for="adminAnnouncementText">ê´€ë¦¬ì ê³µì§€ ë‚´ìš©:</label>
        <textarea id="adminAnnouncementText" placeholder="ê´€ë¦¬ì ì „ìš© ê³µì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
      </div>
      <label class="checkbox-label">
        <input type="checkbox" id="adminAnnouncementActive" />
        <span>ê³µì§€ í™œì„±í™”</span>
      </label>
      <button class="btn btn-success" id="saveAdminAnnouncementBtn">ê³µì§€ ì €ì¥</button>
    </div>

    <!-- ì˜ˆì•½ í˜„í™© -->
    <div class="admin-section">
      <h3>ğŸ“‹ ì˜ˆì•½ í˜„í™©</h3>
      <div style="overflow-x: auto;">
        <table>
          <thead>
            <tr>
              <th>ì´ë¦„</th>
              <th>ë£¸ ë²ˆí˜¸</th>
              <th>ê¸°ìˆ™ì‚¬</th>
              <th>ì¸µ</th>
              <th>ìë¦¬ ë²ˆí˜¸</th>
              <th>ì˜ˆì•½ ì‹œê°„</th>
              <th>ì˜ˆì•½ ë¹„ë°€ë²ˆí˜¸</th>
              <th>ê¸°ëŠ¥</th>
            </tr>
          </thead>
          <tbody id="reservationTableBody"></tbody>
        </table>
      </div>
      <button class="btn btn-danger" id="deleteAllReservationsBtn">ëª¨ë“  ì˜ˆì•½ ì·¨ì†Œ</button>
    </div>
  </div>
</div>

<!-- ê³µì§€ì‚¬í•­ ëª¨ë‹¬ -->
<div id="announcementModal" class="modal">
  <div class="modal-content">
    <h2>ğŸ“¢ ê³µì§€ì‚¬í•­</h2>
    <p id="announcementModalText"></p>
    <button class="btn btn-primary" id="closeAnnouncementModalBtn">ë‹«ê¸°</button>
  </div>
</div>

<!-- ê´€ë¦¬ì ì „ìš© ê³µì§€ì‚¬í•­ ëª¨ë‹¬ -->
<div id="adminAnnouncementModal" class="modal">
  <div class="modal-content">
    <h2>ğŸ”’ ê´€ë¦¬ì ì „ìš© ê³µì§€ì‚¬í•­</h2>
    <p id="adminAnnouncementModalText"></p>
    <button class="btn btn-primary" id="closeAdminAnnouncementModalBtn">ë‹«ê¸°</button>
  </div>
</div>

<!-- ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš© ë™ì˜ ëª¨ë‹¬ -->
  <div id="privacyConsentModal" style="display:none;">
  <div class="modal-content">
    <h2>ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš© ë™ì˜</h2>
    
    <div class="privacy-content">
      <p style="margin-bottom: 15px; line-height: 1.6;">
        ë³¸ ê¸°ìˆ™ì‚¬ ëœì„ ì„ ì˜ˆì•½ ì‹œìŠ¤í…œ(ì´í•˜ 'ë³¸ ì‹œìŠ¤í…œ')ì€ ì •ë³´ì£¼ì²´ì˜ ê°œì¸ì •ë³´ë¥¼ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ë©°, ã€Œê°œì¸ì •ë³´ ë³´í˜¸ë²•ã€ ë“± ê´€ë ¨ ë²•ë ¹ì„ ì¤€ìˆ˜í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ì‚¬í•­ì— ëŒ€í•˜ì—¬ ë™ì˜í•˜ì‹œë©´, ë³¸ ì‹œìŠ¤í…œì„ ì´ìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </p>

      <h3>1. ê°œì¸ì •ë³´ì²˜ë¦¬ìì˜ ëª…ì¹­</h3>
      <p>ë³¸ ì‹œìŠ¤í…œì˜ ê°œì¸ì •ë³´ì²˜ë¦¬ìëŠ” ê³ ì–‘êµ­ì œê³  ê¸°ìˆ™ì‚¬ë¶€ì…ë‹ˆë‹¤. ì—¬ê¸°ì„œ ê³ ì–‘êµ­ì œê³  ê¸°ìˆ™ì‚¬ë¶€ë¼ í•¨ì€ ê¿ˆë™, ë¯¸ë˜ë™ ì‚¬ê°ì‹¤ì„ í¬í•¨í•˜ì—¬ í•™ìƒíšŒ ê¸°ìˆ™ìƒí™œë¶€, ê¸°ìˆ™ì‚¬ ê´€ë ¨ ë¶€ì„œë¥¼ í¬í•¨í•©ë‹ˆë‹¤.</p>

      <h3>2. ê°œì¸ì •ë³´ì˜ ìˆ˜ì§‘ ë° ì´ìš© ëª©ì </h3>
      <p>ë³¸ ì‹œìŠ¤í…œì€ ë‹¤ìŒê³¼ ê°™ì€ ëª©ì ìœ¼ë¡œ í•™ìƒì˜ ê°œì¸ì •ë³´ë¥¼ ìˆ˜ì§‘ ë° ì´ìš©í•©ë‹ˆë‹¤.</p>
      <ul>
        <li>ê¸°ìˆ™ì‚¬ ëœì„ ì„ ì˜ˆì•½ ë° ì¢Œì„ ë°°ì •</li>
        <li>ì˜ˆì•½ì ë³¸ì¸ í™•ì¸ ë° ì¤‘ë³µ ì˜ˆì•½ ë°©ì§€</li>
        <li>ì˜ˆì•½ í˜„í™© ê´€ë¦¬</li>
        <li>ì„œë¹„ìŠ¤ ì´ìš© ê´€ë ¨ ê³µì§€ì‚¬í•­ ì „ë‹¬</li>
      </ul>

      <h3>3. ìˆ˜ì§‘í•˜ëŠ” ê°œì¸ì •ë³´ í•­ëª©</h3>
      <p>ë³¸ ì‹œìŠ¤í…œì€ ì„œë¹„ìŠ¤ ì œê³µì„ ìœ„í•´ ì•„ë˜ì™€ ê°™ì€ ê°œì¸ì •ë³´ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤.</p>
      <ul>
        <li>í•„ìˆ˜í•­ëª©: ì´ë¦„, ë£¸ ë²ˆí˜¸, ê¸°ìˆ™ì‚¬ ê±´ë¬¼ëª…, ì˜ˆì•½ ë¹„ë°€ë²ˆí˜¸</li>
        <li>ìë™ ìˆ˜ì§‘ í•­ëª©: ì ‘ì† ê¸°ê¸° IP ì£¼ì†Œ, ì˜ˆì•½ ì¼ì‹œ, ì¢Œì„ ìœ„ì¹˜(ì¸µ ë° ì¢Œì„ ë²ˆí˜¸)</li>
      </ul>

      <h3>4. ê°œì¸ì •ë³´ì˜ ë³´ìœ  ë° ì´ìš© ê¸°ê°„</h3>
      <p>ìˆ˜ì§‘ëœ ê°œì¸ì •ë³´ëŠ” ì˜ˆì•½ ê´€ë¦¬ ë° í•™ì‚¬ í–‰ì • ëª©ì ì„ ìœ„í•´ í•™ê¸° ì¢…ë£Œ í›„ 1ë…„ê¹Œì§€ ë³´ê´€ë˜ë©°, í•´ë‹¹ ê¸°ê°„ ê²½ê³¼ ì‹œ ì§€ì²´ ì—†ì´ íŒŒê¸°ë©ë‹ˆë‹¤. ë‹¤ë§Œ, ê´€ë ¨ ë²•ë ¹ì— ë”°ë¼ ë³´ì¡´ ì˜ë¬´ê°€ ìˆëŠ” ê²½ìš° í•´ë‹¹ ë²•ë ¹ì´ ì •í•œ ê¸°ê°„ ë™ì•ˆ ë³´ê´€ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

      <h3>5. ê°œì¸ì •ë³´ì˜ íŒŒê¸° ì ˆì°¨ ë° ë°©ë²•</h3>
      <p>ê°œì¸ì •ë³´ëŠ” ë³´ìœ  ê¸°ê°„ì´ ê²½ê³¼í•œ í›„ì—ëŠ” ë‹¤ìŒ ì ˆì°¨ ë° ë°©ë²•ì— ë”°ë¼ íŒŒê¸°ë©ë‹ˆë‹¤.</p>
      <ul>
        <li><strong>íŒŒê¸° ì ˆì°¨:</strong> ì •ë³´ì£¼ì²´ë¡œë¶€í„° ë™ì˜ë°›ì€ ê°œì¸ì •ë³´ ë³´ìœ ê¸°ê°„ì´ ê²½ê³¼í•˜ê±°ë‚˜ ì²˜ë¦¬ ëª©ì ì´ ë‹¬ì„±ëœ í›„ ë‚´ë¶€ ë°©ì¹¨ ë° ê¸°íƒ€ ê´€ë ¨ ë²•ë ¹ì— ë”°ë¼ ì¼ì • ê¸°ê°„ ì €ì¥ëœ í›„ íŒŒê¸°ë©ë‹ˆë‹¤.</li>
        <li><strong>íŒŒê¸° ë°©ë²•:</strong> ì „ìì  íŒŒì¼ í˜•íƒœë¡œ ê¸°ë¡ëœ ê°œì¸ì •ë³´ëŠ” MongoDB Atlas ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì˜êµ¬ ì‚­ì œí•˜ë©°, ì¢…ì´ ë¬¸ì„œì— ê¸°ë¡ëœ ê°œì¸ì •ë³´ëŠ” ë¶„ì‡„ê¸°ë¡œ ë¶„ì‡„í•˜ê±°ë‚˜ ì†Œê°í•˜ì—¬ íŒŒê¸°í•©ë‹ˆë‹¤.</li>
      </ul>

      <h3>6. ê°œì¸ì •ë³´ì˜ ì œ3ì ì œê³µ</h3>
      <p>ë³¸ ì‹œìŠ¤í…œì€ ì •ë³´ì£¼ì²´ì˜ ê°œì¸ì •ë³´ë¥¼ ê°œì¸ì •ë³´ì˜ ìˆ˜ì§‘ ë° ì´ìš© ëª©ì ì—ì„œ ëª…ì‹œí•œ ë²”ìœ„ ë‚´ì—ì„œë§Œ ì´ìš©í•˜ë©°, ì •ë³´ì£¼ì²´ì˜ ì‚¬ì „ ë™ì˜ ì—†ì´ í•´ë‹¹ ë²”ìœ„ë¥¼ ì´ˆê³¼í•˜ì—¬ ì´ìš©í•˜ê±°ë‚˜ ì›ì¹™ì ìœ¼ë¡œ ì œ3ìì—ê²Œ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¨, ë‹¤ìŒì˜ ê²½ìš°ì—ëŠ” ê°œì¸ì •ë³´ë¥¼ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
      <ul>
        <li>ì •ë³´ì£¼ì²´(í•™ìƒ) ë³¸ì¸ì´ ìì‹ ì˜ ì •ë³´ë¥¼ ì—´ëŒí•˜ëŠ” ê²½ìš°</li>
        <li>í•™êµ ì¸¡ì˜ ì •ë‹¹í•œ ìš”ì²­ìœ¼ë¡œ ì˜ˆì•½ ë‚´ì—­ ë“±ì„ ê³µê°œí•´ì•¼ í•˜ëŠ” ê²½ìš°</li>
        <li>ì‹œìŠ¤í…œ ê´€ë¦¬ ê¶Œí•œì„ ê°€ì§„ ë‹´ë‹¹ êµì‚¬ ë˜ëŠ” ê´€ë¦¬ìê°€ í•™ìƒë“¤ì˜ ì˜ˆì•½ í˜„í™©ì„ ì¡°íšŒí•˜ëŠ” ê²½ìš°</li>
        <li>ë²•ë ¹ì˜ ê·œì •ì— ì˜ê±°í•˜ê±°ë‚˜, ìˆ˜ì‚¬ ëª©ì ìœ¼ë¡œ ë²•ë ¹ì— ì •í•´ì§„ ì ˆì°¨ì™€ ë°©ë²•ì— ë”°ë¼ ìˆ˜ì‚¬ê¸°ê´€ì˜ ìš”êµ¬ê°€ ìˆëŠ” ê²½ìš°</li>
      </ul>

      <h3>7. ê°œì¸ì •ë³´ ì²˜ë¦¬ ì—…ë¬´ì˜ ìœ„íƒ</h3>
      <p>ë³¸ ì‹œìŠ¤í…œì€ ì›í™œí•œ ê°œì¸ì •ë³´ ì²˜ë¦¬ ì—…ë¬´ë¥¼ ìœ„í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì´ ê°œì¸ì •ë³´ ì²˜ë¦¬ ì—…ë¬´ë¥¼ ìœ„íƒí•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
      <ul>
        <li><strong>ìˆ˜íƒì—…ì²´:</strong> Render (í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ ì œê³µ ë° ë°±ì—”ë“œ ì„œë²„ ìš´ì˜)</li>
        <li><strong>ìˆ˜íƒì—…ì²´:</strong> Netlify (í”„ë¡ íŠ¸ì—”ë“œ ì›¹ì‚¬ì´íŠ¸ í˜¸ìŠ¤íŒ… ë° ìš´ì˜)</li>
        <li><strong>ìˆ˜íƒì—…ì²´:</strong> MongoDB Atlas (ë°ì´í„°ë² ì´ìŠ¤ ì„œë¹„ìŠ¤ ì œê³µ)</li>
        <li><strong>ìœ„íƒ ì—…ë¬´ ë‚´ìš©:</strong> ì‹œìŠ¤í…œ ì„œë²„ ìš´ì˜ ë° ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬, ì„œë¹„ìŠ¤ ì¸í”„ë¼ ì œê³µ ë“±</li>
      </ul>
      <p>ìœ„íƒ ê³„ì•½ ì‹œ ã€Œê°œì¸ì •ë³´ ë³´í˜¸ë²•ã€ ë“± ê´€ë ¨ ë²•ë ¹ì— ë”°ë¼ ìœ„íƒ ì—…ë¬´ ìˆ˜í–‰ ëª©ì  ì™¸ ê°œì¸ì •ë³´ ì²˜ë¦¬ ê¸ˆì§€, ê¸°ìˆ ì Â·ê´€ë¦¬ì  ë³´í˜¸ì¡°ì¹˜ ë“± ì±…ì„ì— ê´€í•œ ì‚¬í•­ì„ í™•ì¸í•˜ê³  ìˆ˜íƒìê°€ ê°œì¸ì •ë³´ë¥¼ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ ê°ë…í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>

      <h3>8. ì •ë³´ì£¼ì²´ì˜ ê¶Œë¦¬ í–‰ì‚¬ ë°©ë²•</h3>
      <p>ì •ë³´ì£¼ì²´(í•™ìƒ)ëŠ” ì–¸ì œë“ ì§€ ê°œì¸ì •ë³´ ì—´ëŒ, ì •ì •Â·ì‚­ì œ, ì²˜ë¦¬ì •ì§€ ìš”ì²­ ë° ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ë™ì˜ ì² íšŒë¥¼ ìš”êµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê¶Œë¦¬ í–‰ì‚¬ëŠ” ë‹´ë‹¹ ë¶€ì„œ ë˜ëŠ” ê´€ë¦¬ìì—ê²Œ ì„œë©´, ì „í™” ë“±ì„ í†µí•˜ì—¬ ìš”ì²­í•˜ì‹œë©´ ì§€ì²´ ì—†ì´ ì¡°ì¹˜í•˜ê² ìŠµë‹ˆë‹¤. ë‹¨, ê¶Œë¦¬ í–‰ì‚¬ ì‹œ ê´€ë¦¬ìê°€ ë³¸ì¸ í™•ì¸ ë“±ì˜ í™•ì¸ ì ˆì°¨ë¥¼ ê±°ì¹˜ê¸° ìœ„í•´ ì¶”ê°€ì ì¸ ê°œì¸ì •ë³´ë¥¼ ìš”êµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

      <h3>9. ë™ì˜ ê±°ë¶€ê¶Œ ë° ë¶ˆì´ìµ</h3>
      <p>ê·€í•˜ëŠ” ìœ„ ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ëŒ€í•œ ë™ì˜ë¥¼ ê±°ë¶€í•  ê¶Œë¦¬ê°€ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ, í•„ìˆ˜í•­ëª©ì— ëŒ€í•œ ë™ì˜ë¥¼ ê±°ë¶€í•˜ì‹¤ ê²½ìš°, ë³¸ ì‹œìŠ¤í…œì˜ ëœì„ ì„ ì˜ˆì•½ ì„œë¹„ìŠ¤ ì´ìš©ì´ ì œí•œë©ë‹ˆë‹¤.</p>

      <h3>10. ê°œì¸ì •ë³´ì˜ ì•ˆì „ì„± í™•ë³´ ì¡°ì¹˜</h3>
      <p>ë³¸ ì‹œìŠ¤í…œì€ ã€Œê°œì¸ì •ë³´ ë³´í˜¸ë²•ã€ ì œ29ì¡°ì— ë”°ë¼ ë‹¤ìŒê³¼ ê°™ì´ ì•ˆì „ì„± í™•ë³´ì— í•„ìš”í•œ ê¸°ìˆ ì Â·ê´€ë¦¬ì  ë° ë¬¼ë¦¬ì  ì¡°ì¹˜ë¥¼ í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
      <ul>
        <li>ê°œì¸ì •ë³´ ì·¨ê¸‰ ë‹´ë‹¹ìì˜ ìµœì†Œí™” ë° êµìœ¡</li>
        <li>ë‚´ë¶€ ê´€ë¦¬ ê³„íš ìˆ˜ë¦½ ë° ì‹œí–‰</li>
        <li>ê°œì¸ì •ë³´ ë°ì´í„° ì•”í˜¸í™” (ë¹„ë°€ë²ˆí˜¸ bcrypt í•´ì‹± ì²˜ë¦¬)</li>
        <li>ê°œì¸ì •ë³´ ì¡°íšŒ ì‹œ ë¡œê·¸ì¸ ë° ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ í•„ìš”</li>
        <li>ê°œì¸ì •ë³´ ë°ì´í„°ë² ì´ìŠ¤ì— ëŒ€í•œ ì ‘ê·¼ í†µì œ ë° ì ‘ê·¼ ê¶Œí•œ ì œí•œ</li>
        <li>ì ‘ì† ê¸°ë¡ì˜ ë³´ê´€ ë° ìœ„Â·ë³€ì¡° ë°©ì§€ ì¡°ì¹˜</li>
        <li>ë³´ì•ˆ í”„ë¡œê·¸ë¨ ì„¤ì¹˜ ë° ì£¼ê¸°ì  ê°±ì‹ </li>
        <li>ìƒì„±í˜• ì¸ê³µì§€ëŠ¥ ë“±ì˜ AIë¥¼ í™œìš©í•œ ì ‘ê·¼ ì œí•œ</li>
      </ul>

      <h3>11. ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨ ë³€ê²½ì— ê´€í•œ ì‚¬í•­</h3>
      <p>ë³¸ ì²˜ë¦¬ë°©ì¹¨ì€ 2025ë…„ 11ì›” 18ì¼ë¶€í„° ì ìš©ë©ë‹ˆë‹¤. ë²•ë ¹ ë° ë°©ì¹¨ì— ë”°ë¥¸ ë³€ê²½ ë‚´ìš© ì¶”ê°€, ì‚­ì œ ë° ì •ì •ì´ ìˆì„ ê²½ìš°ì—ëŠ” ë³€ê²½ì‚¬í•­ ì‹œí–‰ 7ì¼ ì „ë¶€í„° ì›¹ì‚¬ì´íŠ¸ ê³µì§€ì‚¬í•­ì„ í†µí•˜ì—¬ ê³ ì§€í•˜ë©°, ë¶ˆê°€í”¼í•˜ê²Œ ì •ë³´ì£¼ì²´ì˜ ê¶Œë¦¬ ë˜ëŠ” ì˜ë¬´ì— ì¤‘ëŒ€í•œ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ë³€ê²½ì˜ ê²½ìš°ì—ëŠ” 30ì¼ ì „ë¶€í„° ê³ ì§€í•©ë‹ˆë‹¤.</p>
    </div>
    
    <div class="consent-checkbox-wrapper">
      <label>
        <input type="checkbox" id="privacyConsentCheck">
        ìœ„ ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš©ì— ë™ì˜í•©ë‹ˆë‹¤.
      </label>
    </div>
    
    <div class="privacy-buttons">
      <button id="privacyConsentAgreeBtn">ë™ì˜</button>
      <button id="privacyConsentCancelBtn">ì·¨ì†Œ</button>
    </div>
  </div>
</div>

<script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
<script>
  (function(){
    'use strict';

    // API ê¸°ë³¸ URL (ë°°í¬ ì‹œ ì‹¤ì œ ì„œë²„ URLë¡œ ë³€ê²½)
    const API_BASE = 'http://localhost:3000';

    // Socket.IO ì—°ê²°
    const socket = io(API_BASE);

    // ì „ì—­ ë³€ìˆ˜
    let currentUser = null;
    let selectedFloor = null;
    let selectedSeat = null;
    let allReservations = [];
    let adminCredentials = null;

    // DOM ìš”ì†Œ
    const loginPage = document.getElementById('loginPage');
    const floorSelectPage = document.getElementById('floorSelectPage');
    const seatSelectPage = document.getElementById('seatSelectPage');
    const adminLoginPage = document.getElementById('adminLoginPage');
    const adminPage = document.getElementById('adminPage');

    const roomNoInput = document.getElementById('roomNoInput');
    const nameInput = document.getElementById('nameInput');
    const dormitorySelect = document.getElementById('dormitorySelect');
    const passwordInput = document.getElementById('passwordInput');
    const loginSubmitBtn = document.getElementById('loginSubmitBtn');
    const goToAdminLoginBtn = document.getElementById('goToAdminLoginBtn');

    const userNameDisplay = document.getElementById('userNameDisplay');
    const floorButtons = document.querySelectorAll('.floor-btn');
    const backToLoginFromFloorBtn = document.getElementById('backToLoginFromFloorBtn');
    const goToSeatSelectionBtn = document.getElementById('goToSeatSelectionBtn');

    const currentFloorDisplay = document.getElementById('currentFloorDisplay');
    const seatGrid = document.getElementById('seatGrid');
    const backToFloorFromSeatBtn = document.getElementById('backToFloorFromSeatBtn');
    const cancelReservationBtn = document.getElementById('cancelReservationBtn');
    const confirmReservationBtn = document.getElementById('confirmReservationBtn');

    const adminUsernameInput = document.getElementById('adminUsernameInput');
    const adminPasswordInput = document.getElementById('adminPasswordInput');
    const adminLoginSubmitBtn = document.getElementById('adminLoginSubmitBtn');
    const backToLoginFromAdminBtn = document.getElementById('backToLoginFromAdminBtn');

    const adminLogoutBtn = document.getElementById('adminLogoutBtn');
    const reservationStartTime = document.getElementById('reservationStartTime');
    const reservationEndTime = document.getElementById('reservationEndTime');
    const saveTimesBtn = document.getElementById('saveTimesBtn');
    const announcementText = document.getElementById('announcementText');
    const announcementActive = document.getElementById('announcementActive');
    const saveAnnouncementBtn = document.getElementById('saveAnnouncementBtn');
    const adminAnnouncementText = document.getElementById('adminAnnouncementText');
    const adminAnnouncementActive = document.getElementById('adminAnnouncementActive');
    const saveAdminAnnouncementBtn = document.getElementById('saveAdminAnnouncementBtn');
    const reservationTableBody = document.getElementById('reservationTableBody');
    const deleteAllReservationsBtn = document.getElementById('deleteAllReservationsBtn');

    const announcementModal = document.getElementById('announcementModal');
    const announcementModalText = document.getElementById('announcementModalText');
    const closeAnnouncementModalBtn = document.getElementById('closeAnnouncementModalBtn');

    const adminAnnouncementModal = document.getElementById('adminAnnouncementModal');
    const adminAnnouncementModalText = document.getElementById('adminAnnouncementModalText');
    const closeAdminAnnouncementModalBtn = document.getElementById('closeAdminAnnouncementModalBtn');

    // ê°œì¸ì •ë³´ ë™ì˜ ëª¨ë‹¬ ìš”ì†Œ
    const privacyConsentModal = document.getElementById('privacyConsentModal');
    const privacyConsentCheck = document.getElementById('privacyConsentCheck');
    const privacyConsentAgreeBtn = document.getElementById('privacyConsentAgreeBtn');
    const privacyConsentCancelBtn = document.getElementById('privacyConsentCancelBtn');

    // í™”ë©´ ì „í™˜ í•¨ìˆ˜
    function showSection(section) {
      [loginPage, floorSelectPage, seatSelectPage, adminLoginPage, adminPage].forEach(s => {
        if (s) s.classList.remove('active');
      });
      if (section) section.classList.add('active');
    }

    // ê°œì¸ì •ë³´ ë™ì˜ ëª¨ë‹¬ í‘œì‹œ í•¨ìˆ˜
    function showPrivacyConsentModal(roomNo, name, dormitory, password) {
      privacyConsentCheck.checked = false;
      privacyConsentModal.classList.add('active');
      
      privacyConsentAgreeBtn.onclick = async function() {
        if(!privacyConsentCheck.checked) {
          alert('ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš©ì— ë™ì˜í•´ì£¼ì„¸ìš”.');
          return;
        }
        
        try {
          const response = await fetch(`${API_BASE}/api/privacy-consent`, {
            method: 'POST',
            headers: {'Content-Type':'application/json'},
            body: JSON.stringify({roomNo, name, dormitory})
          });
          
          const data = await response.json();
          
          if(data.success) {
            privacyConsentModal.classList.remove('active');
            proceedToFloorSelection(roomNo, name, dormitory, password);
          } else {
            alert('ë™ì˜ ì •ë³´ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
          }
        } catch(err) {
          console.error('ê°œì¸ì •ë³´ ë™ì˜ ì €ì¥ ì‹¤íŒ¨:', err);
          alert('ì„œë²„ì™€ì˜ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      };
      
      privacyConsentCancelBtn.onclick = function() {
        privacyConsentModal.classList.remove('active');
        alert('ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš©ì— ë™ì˜í•˜ì§€ ì•Šìœ¼ë©´ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      };
    }

    // ì¸µ ì„ íƒ í™”ë©´ìœ¼ë¡œ ì´ë™
    function proceedToFloorSelection(roomNo, name, dormitory, password) {
      currentUser = {roomNo, name, dormitory, password};
      userNameDisplay.textContent = name;
      showSection(floorSelectPage);
    }

    // ë¡œê·¸ì¸ ë‹¤ìŒ ë²„íŠ¼
    if (loginSubmitBtn) {
      loginSubmitBtn.addEventListener('click', async function(){
        const roomNo = roomNoInput.value.trim();
        const name = nameInput.value.trim();
        const dormitory = dormitorySelect.value;
        const password = passwordInput.value.trim();
        
        if(!roomNo){
          alert('ë£¸ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
          return;
        }
        const roomNoPattern = /^\d{3}$/;
        if(!roomNoPattern.test(roomNo)){
          alert('ë£¸ ë²ˆí˜¸ëŠ” 000í˜¸ í˜•ì‹(3ìë¦¬ ìˆ«ì)ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
          return;
        }
        if(!name){
          alert('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
          return;
        }
        const namePattern = /^[ê°€-í£]{2,4}$/;
        if(!namePattern.test(name)){
          alert('ì´ë¦„ì€ í•œê¸€ 2~4ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
          return;
        }
        if(!dormitory){
          alert('ê¸°ìˆ™ì‚¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
          return;
        }
        if(!password){
          alert('ì˜ˆì•½ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
          return;
        }
        if(password.length < 4){
          alert('ì˜ˆì•½ ë¹„ë°€ë²ˆí˜¸ëŠ” 4ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
          return;
        }
        
        // ê°œì¸ì •ë³´ ë™ì˜ í™•ì¸
        try {
          const checkResponse = await fetch(`${API_BASE}/api/privacy-consent/check`, {
            method: 'POST',
            headers: {'Content-Type':'application/json'},
            body: JSON.stringify({roomNo, name, dormitory})
          });
          
          const checkData = await checkResponse.json();
          
          if(!checkData.success) {
            alert('ê°œì¸ì •ë³´ ë™ì˜ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            return;
          }
          
          if(checkData.hasConsent) {
            proceedToFloorSelection(roomNo, name, dormitory, password);
          } else {
            showPrivacyConsentModal(roomNo, name, dormitory, password);
          }
        } catch(err) {
          console.error('ê°œì¸ì •ë³´ ë™ì˜ í™•ì¸ ì‹¤íŒ¨:', err);
          alert('ì„œë²„ì™€ì˜ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      });
    }

    // ê´€ë¦¬ì ë¡œê·¸ì¸ ë²„íŠ¼
    if (goToAdminLoginBtn) {
      goToAdminLoginBtn.addEventListener('click', () => showSection(adminLoginPage));
    }

    // ë’¤ë¡œê°€ê¸° ë²„íŠ¼ë“¤
    if (backToLoginFromFloorBtn) {
      backToLoginFromFloorBtn.addEventListener('click', () => {
        showSection(loginPage);
        currentUser = null;
        selectedFloor = null;
      });
    }

    if (backToFloorFromSeatBtn) {
      backToFloorFromSeatBtn.addEventListener('click', () => {
        showSection(floorSelectPage);
        selectedSeat = null;
      });
    }

    if (backToLoginFromAdminBtn) {
      backToLoginFromAdminBtn.addEventListener('click', () => showSection(loginPage));
    }

    // ì¸µ ì„ íƒ ë²„íŠ¼
    floorButtons.forEach(btn => {
      btn.addEventListener('click', function(){
        selectedFloor = this.dataset.floor;
      });
    });

    // ì¢Œì„ ì„ íƒìœ¼ë¡œ ì´ë™
    if (goToSeatSelectionBtn) {
      goToSeatSelectionBtn.addEventListener('click', function(){
        if(!selectedFloor){
          alert('ì¸µì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
          return;
        }
        currentFloorDisplay.textContent = selectedFloor;
        renderSeats();
        showSection(seatSelectPage);
      });
    }

    // ì¢Œì„ ë Œë”ë§
    function renderSeats() {
      seatGrid.innerHTML = '';
      for(let i = 1; i <= 50; i++){
        const seat = document.createElement('div');
        seat.className = 'seat';
        seat.textContent = i;
        seat.dataset.seat = i;
        
        const reservation = allReservations.find(r => 
          r.dormitory === currentUser.dormitory && 
          r.floor === selectedFloor && 
          r.seat === i
        );
        
        if(reservation){
          if(reservation.roomNo === currentUser.roomNo && reservation.name === currentUser.name){
            seat.classList.add('my-seat');
            selectedSeat = i;
          } else {
            seat.classList.add('reserved');
          }
        } else {
          seat.classList.add('available');
        }
        
        seat.addEventListener('click', function(){
          if(this.classList.contains('reserved')){
            alert('ì´ë¯¸ ì˜ˆì•½ëœ ì¢Œì„ì…ë‹ˆë‹¤.');
            return;
          }
          
          document.querySelectorAll('.seat').forEach(s => {
            if(!s.classList.contains('reserved') && !s.classList.contains('my-seat')){
              s.classList.remove('my-seat');
              s.classList.add('available');
            }
          });
          
          if(this.classList.contains('my-seat')){
            this.classList.remove('my-seat');
            this.classList.add('available');
            selectedSeat = null;
          } else {
            this.classList.remove('available');
            this.classList.add('my-seat');
            selectedSeat = parseInt(this.dataset.seat);
          }
        });
        
        seatGrid.appendChild(seat);
      }
    }

    // ì˜ˆì•½ í™•ì •
    if (confirmReservationBtn) {
      confirmReservationBtn.addEventListener('click', async function(){
        if(!selectedSeat){
          alert('ì¢Œì„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
          return;
        }
        
        try {
          const response = await fetch(`${API_BASE}/api/reservations`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
              roomNo: currentUser.roomNo,
              name: currentUser.name,
              dormitory: currentUser.dormitory,
              floor: selectedFloor,
              seat: selectedSeat,
              password: currentUser.password
            })
          });
          
          const data = await response.json();
          
          if(response.ok && data.success){
            alert(data.message || 'ì˜ˆì•½ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');
          } else {
            alert(data.message || 'ì˜ˆì•½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
          }
        } catch(err){
          console.error('ì˜ˆì•½ ìš”ì²­ ì‹¤íŒ¨:', err);
          alert('ì„œë²„ì™€ì˜ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      });
    }

    // ì˜ˆì•½ ì·¨ì†Œ
    if (cancelReservationBtn) {
      cancelReservationBtn.addEventListener('click', async function(){
        const myReservation = allReservations.find(r => 
          r.roomNo === currentUser.roomNo && 
          r.name === currentUser.name
        );
        
        if(!myReservation){
          alert('ì·¨ì†Œí•  ì˜ˆì•½ì´ ì—†ìŠµë‹ˆë‹¤.');
          return;
        }
        
        if(!confirm('ì •ë§ë¡œ ì˜ˆì•½ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')){
          return;
        }
        
        try {
          const response = await fetch(`${API_BASE}/api/reservations/${myReservation._id}`, {
            method: 'DELETE',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({password: currentUser.password})
          });
          
          const data = await response.json();
          
          if(response.ok && data.success){
            alert('ì˜ˆì•½ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');
            selectedSeat = null;
          } else {
            alert(data.message || 'ì˜ˆì•½ ì·¨ì†Œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
          }
        } catch(err){
          console.error('ì˜ˆì•½ ì·¨ì†Œ ì‹¤íŒ¨:', err);
          alert('ì„œë²„ì™€ì˜ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      });
    }

    // ê´€ë¦¬ì ë¡œê·¸ì¸
    if (adminLoginSubmitBtn) {
      adminLoginSubmitBtn.addEventListener('click', async function(){
        const username = adminUsernameInput.value.trim();
        const password = adminPasswordInput.value.trim();
        
        if(!username || !password){
          alert('ê´€ë¦¬ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
          return;
        }
        
        try {
          const response = await fetch(`${API_BASE}/api/admin-login`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({username, password})
          });
          
          const data = await response.json();
          
          if(response.ok && data.success){
            adminCredentials = {username, password};
            showSection(adminPage);
            loadAdminData();
          } else {
            alert(data.message || 'ë¡œê·¸ì¸ ì‹¤íŒ¨');
          }
        } catch(err){
          console.error('ê´€ë¦¬ì ë¡œê·¸ì¸ ì‹¤íŒ¨:', err);
          alert('ì„œë²„ì™€ì˜ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      });
    }

    // ê´€ë¦¬ì ë¡œê·¸ì•„ì›ƒ
    if (adminLogoutBtn) {
      adminLogoutBtn.addEventListener('click', function(){
        adminCredentials = null;
        adminUsernameInput.value = '';
        adminPasswordInput.value = '';
        showSection(loginPage);
      });
    }

    // ê´€ë¦¬ì ë°ì´í„° ë¡œë“œ
    async function loadAdminData() {
      try {
        const response = await fetch(`${API_BASE}/api/admin-settings`);
        const settings = await response.json();
        
        if(settings.reservationStartTime){
          reservationStartTime.value = new Date(settings.reservationStartTime).toISOString().slice(0,16);
        }
        if(settings.reservationEndTime){
          reservationEndTime.value = new Date(settings.reservationEndTime).toISOString().slice(0,16);
        }
      } catch(err){
        console.error('ê´€ë¦¬ì ì„¤ì • ë¡œë“œ ì‹¤íŒ¨:', err);
      }
      
      try {
        const response = await fetch(`${API_BASE}/api/announcement`);
        const announcement = await response.json();
        
        announcementText.value = announcement.message || '';
        announcementActive.checked = announcement.active || false;
      } catch(err){
        console.error('ê³µì§€ì‚¬í•­ ë¡œë“œ ì‹¤íŒ¨:', err);
      }
      
      try {
        const response = await fetch(`${API_BASE}/api/admin-announcement`);
        const adminAnnouncement = await response.json();
        
        adminAnnouncementText.value = adminAnnouncement.message || '';
        adminAnnouncementActive.checked = adminAnnouncement.active || false;
      } catch(err){
        console.error('ê´€ë¦¬ì ì „ìš© ê³µì§€ì‚¬í•­ ë¡œë“œ ì‹¤íŒ¨:', err);
      }
      
      updateReservationTable();
    }

    // ì˜ˆì•½ ì‹œê°„ ì„¤ì • ì €ì¥
    if (saveTimesBtn) {
      saveTimesBtn.addEventListener('click', async function(){
        const startTime = reservationStartTime.value;
        const endTime = reservationEndTime.value;
        
        if(!startTime || !endTime){
          alert('ì‹œì‘ ì‹œê°„ê³¼ ì¢…ë£Œ ì‹œê°„ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
          return;
        }
        
        try {
          const response = await fetch(`${API_BASE}/api/admin-settings`, {
            method: 'PUT',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
              reservationStartTime: new Date(startTime).toISOString(),
              reservationEndTime: new Date(endTime).toISOString(),
              adminUsername: adminCredentials.username,
              adminPassword: adminCredentials.password
            })
          });
          
          const data = await response.json();
          
          if(response.ok && data.success){
            alert('ì˜ˆì•½ ê°€ëŠ¥ ì‹œê°„ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
          } else {
            alert(data.message || 'ì„¤ì • ì €ì¥ ì‹¤íŒ¨');
          }
        } catch(err){
          console.error('ì˜ˆì•½ ì‹œê°„ ì„¤ì • ì‹¤íŒ¨:', err);
          alert('ì„œë²„ì™€ì˜ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      });
    }

    // ê³µì§€ì‚¬í•­ ì €ì¥
    if (saveAnnouncementBtn) {
      saveAnnouncementBtn.addEventListener('click', async function(){
        const message = announcementText.value;
        const active = announcementActive.checked;
        
        try {
          const response = await fetch(`${API_BASE}/api/announcement`, {
            method: 'PUT',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
              message,
              active,
              adminUsername: adminCredentials.username,
              adminPassword: adminCredentials.password
            })
          });
          
          const data = await response.json();
          
          if(response.ok && data.success){
            alert('ê³µì§€ì‚¬í•­ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
          } else {
            alert(data.message || 'ê³µì§€ ì €ì¥ ì‹¤íŒ¨');
          }
        } catch(err){
          console.error('ê³µì§€ì‚¬í•­ ì €ì¥ ì‹¤íŒ¨:', err);
          alert('ì„œë²„ì™€ì˜ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      });
    }

    // ê´€ë¦¬ì ì „ìš© ê³µì§€ì‚¬í•­ ì €ì¥
    if (saveAdminAnnouncementBtn) {
      saveAdminAnnouncementBtn.addEventListener('click', async function(){
        const message = adminAnnouncementText.value;
        const active = adminAnnouncementActive.checked;
        
        try {
          const response = await fetch(`${API_BASE}/api/admin-announcement`, {
            method: 'PUT',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
              message,
              active,
              adminUsername: adminCredentials.username,
              adminPassword: adminCredentials.password
            })
          });
          
          const data = await response.json();
          
          if(response.ok && data.success){
            alert('ê´€ë¦¬ì ì „ìš© ê³µì§€ì‚¬í•­ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
          } else {
            alert(data.message || 'ê³µì§€ ì €ì¥ ì‹¤íŒ¨');
          }
        } catch(err){
          console.error('ê´€ë¦¬ì ì „ìš© ê³µì§€ì‚¬í•­ ì €ì¥ ì‹¤íŒ¨:', err);
          alert('ì„œë²„ì™€ì˜ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      });
    }

    // ì˜ˆì•½ í˜„í™© í…Œì´ë¸” ì—…ë°ì´íŠ¸
    function updateReservationTable() {
      reservationTableBody.innerHTML = '';
      
      allReservations.forEach(reservation => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${reservation.name}</td>
          <td>${reservation.roomNo}</td>
          <td>${reservation.dormitory}</td>
          <td>${reservation.floor}</td>
          <td>${reservation.seat}</td>
          <td>${new Date(reservation.createdAt).toLocaleString('ko-KR')}</td>
          <td>
            <button class="btn-small btn-info view-password-btn" data-id="${reservation._id}">ë³´ê¸°</button>
            <span id="password-${reservation._id}">****</span>
          </td>
          <td>
            <button class="btn-small btn-danger cancel-btn" data-id="${reservation._id}">ì·¨ì†Œ</button>
          </td>
        `;
        reservationTableBody.appendChild(tr);
      });
      
      document.querySelectorAll('.view-password-btn').forEach(btn => {
        btn.addEventListener('click', async function(){
          const id = this.dataset.id;
          
          try {
            const response = await fetch(`${API_BASE}/api/admin/reservations/${id}/view-plain-password`, {
              method: 'POST',
              headers: {'Content-Type': 'application/json'},
              body: JSON.stringify({
                adminUsername: adminCredentials.username,
                adminPassword: adminCredentials.password
              })
            });
            
            const data = await response.json();
            
            if(response.ok && data.success){
              document.getElementById(`password-${id}`).textContent = data.plainPassword;
            } else {
              alert(data.message || 'ë¹„ë°€ë²ˆí˜¸ ì¡°íšŒ ì‹¤íŒ¨');
            }
          } catch(err){
            console.error('ë¹„ë°€ë²ˆí˜¸ ì¡°íšŒ ì‹¤íŒ¨:', err);
            alert('ì„œë²„ì™€ì˜ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
          }
        });
      });
      
      document.querySelectorAll('.cancel-btn').forEach(btn => {
        btn.addEventListener('click', async function(){
          const id = this.dataset.id;
          
          if(!confirm('ì •ë§ë¡œ ì´ ì˜ˆì•½ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')){
            return;
          }
          
          try {
            const response = await fetch(`${API_BASE}/api/reservations/${id}`, {
              method: 'DELETE',
              headers: {'Content-Type': 'application/json'},
              body: JSON.stringify({adminUsername: adminCredentials.username})
            });
            
            const data = await response.json();
            
            if(response.ok && data.success){
              alert('ì˜ˆì•½ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');
            } else {
              alert(data.message || 'ì˜ˆì•½ ì·¨ì†Œ ì‹¤íŒ¨');
            }
          } catch(err){
            console.error('ì˜ˆì•½ ì·¨ì†Œ ì‹¤íŒ¨:', err);
            alert('ì„œë²„ì™€ì˜ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
          }
        });
      });
    }

    // ëª¨ë“  ì˜ˆì•½ ì·¨ì†Œ
    if (deleteAllReservationsBtn) {
      deleteAllReservationsBtn.addEventListener('click', async function(){
        if(!confirm('ì •ë§ë¡œ ëª¨ë“  ì˜ˆì•½ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')){
          return;
        }
        
        try {
          const response = await fetch(`${API_BASE}/api/reservations/all`, {
            method: 'DELETE',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
              adminUsername: adminCredentials.username,
              adminPassword: adminCredentials.password
            })
          });
          
          const data = await response.json();
          
          if(response.ok && data.success){
            alert('ëª¨ë“  ì˜ˆì•½ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');
          } else {
            alert(data.message || 'ì˜ˆì•½ ì·¨ì†Œ ì‹¤íŒ¨');
          }
        } catch(err){
          console.error('ì „ì²´ ì˜ˆì•½ ì·¨ì†Œ ì‹¤íŒ¨:', err);
          alert('ì„œë²„ì™€ì˜ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      });
    }

    // ê³µì§€ì‚¬í•­ ëª¨ë‹¬ ë‹«ê¸°
    if (closeAnnouncementModalBtn) {
      closeAnnouncementModalBtn.addEventListener('click', () => {
        announcementModal.classList.remove('active');
      });
    }

    if (closeAdminAnnouncementModalBtn) {
      closeAdminAnnouncementModalBtn.addEventListener('click', () => {
        adminAnnouncementModal.classList.remove('active');
      });
    }

    // Socket.IO ì´ë²¤íŠ¸
    socket.on('reservationsInitial', (reservations) => {
      allReservations = reservations;
      if(selectedFloor && currentUser){
        renderSeats();
      }
    });

    socket.on('reservationsUpdated', (reservations) => {
      allReservations = reservations;
      if(selectedFloor && currentUser){
        renderSeats();
      }
      if(adminCredentials){
        updateReservationTable();
      }
    });

    socket.on('announcementInitial', (announcement) => {
      if(announcement && announcement.active && announcement.message){
        announcementModalText.textContent = announcement.message;
        announcementModal.classList.add('active');
      }
    });

    socket.on('announcementUpdated', (announcement) => {
      if(announcement && announcement.active && announcement.message){
        announcementModalText.textContent = announcement.message;
        announcementModal.classList.add('active');
      } else {
        announcementModal.classList.remove('active');
      }
    });

    socket.on('adminOnlyAnnouncementInitial', (announcement) => {
      if(adminCredentials && announcement && announcement.active && announcement.message){
        adminAnnouncementModalText.textContent = announcement.message;
        adminAnnouncementModal.classList.add('active');
      }
    });

    socket.on('adminAnnouncementUpdated', (announcement) => {
      if(adminCredentials && announcement && announcement.active && announcement.message){
        adminAnnouncementModalText.textContent = announcement.message;
        adminAnnouncementModal.classList.add('active');
      } else {
        adminAnnouncementModal.classList.remove('active');
      }
    });

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ë°ì´í„°
    window.addEventListener('load', async () => {
      try {
        const response = await fetch(`${API_BASE}/api/reservations`);
        allReservations = await response.json();
      } catch(err){
        console.error('ì´ˆê¸° ì˜ˆì•½ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', err);
      }
    });

    // ë¹„ë°€ë²ˆí˜¸ ê°•ë„ ì²´í¬ í•¨ìˆ˜
    function checkPasswordStrength() {
      const password = passwordInput ? passwordInput.value : '';
      const strengthDiv = document.getElementById('passwordStrength');
      
      if (!password || !strengthDiv) return;
      
      let strength = 0;
      if (password.length >= 4) strength++;
      if (password.length >= 8) strength++;
      if (/[a-zA-Z]/.test(password) && /[0-9]/.test(password)) strength++;
      if (/[^a-zA-Z0-9]/.test(password)) strength++;
      
      if (password.length < 4) {
        strengthDiv.textContent = '';
      } else if (strength <= 1) {
        strengthDiv.textContent = 'ì•½í•¨';
        strengthDiv.className = 'password-strength strength-weak';
      } else if (strength === 2) {
        strengthDiv.textContent = 'ë³´í†µ';
        strengthDiv.className = 'password-strength strength-medium';
      } else {
        strengthDiv.textContent = 'ê°•í•¨';
        strengthDiv.className = 'password-strength strength-strong';
      }
      
      // ëª¨ë“  í•„ë“œê°€ ì±„ì›Œì¡ŒëŠ”ì§€ í™•ì¸
      const roomNo = roomNoInput ? roomNoInput.value.trim() : '';
      const userName = nameInput ? nameInput.value.trim() : '';
      const dormitory = dormitorySelect ? dormitorySelect.value : '';
      
      if (loginSubmitBtn) {
        loginSubmitBtn.disabled = !(roomNo && userName && dormitory && password.length >= 4);
      }
    }

    // ì…ë ¥ í•„ë“œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    document.addEventListener('DOMContentLoaded', function() {
      if (passwordInput) passwordInput.addEventListener('input', checkPasswordStrength);
      if (roomNoInput) roomNoInput.addEventListener('input', checkPasswordStrength);
      if (nameInput) nameInput.addEventListener('input', checkPasswordStrength);
      if (dormitorySelect) dormitorySelect.addEventListener('change', checkPasswordStrength);
      
      // ì´ˆê¸° ìƒíƒœ
      if (loginSubmitBtn) loginSubmitBtn.disabled = true;
      showSection(loginPage);
    });
  })();
</script>
</body>
</html>
